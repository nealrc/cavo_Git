var CurrentRowId,CurrentRowObj,blockoption={message:'<img src="../../../Assets/images/loader-bigcircle.gif" alt="loading...">',css:{background:"none",border:"none",padding:0},overlayCSS:{opacity:0},baseZ:2E3};
$(document).ready(function(){$("#userscoretable").jqGrid({url:"calls/getstudentsc.php",datatype:"json",width:750,height:450,colNames:["Index","First name","Last name","Enrollment","Test Date","Test","Duration","Score","School"],colModel:[{name:"id",index:"id",hidden:true,search:false},{name:"Firstname",index:"Firstname",width:40,search:true,searchoptions:{sopt:["eq"]}},{name:"Lastname",index:"Lastname",width:50,search:true,searchoptions:{sopt:["eq"]}},{name:"EnrollmentYear",index:"EnrollmentYear",
width:50,search:true,searchoptions:{sopt:["eq","gt","lt","ge","le"]}},{name:"date",index:"date",width:50,search:true,searchoptions:{sopt:["eq","gt","lt","ge","le"]}},{name:"test",index:"test",width:100,search:true,stype:"select",searchoptions:{sopt:["eq"],dataUrl:"calls/gettest.php"}},{name:"duration",index:"duration",width:30,search:true,searchoptions:{sopt:["eq","gt","lt","ge","le"]}},{name:"score",index:"score",width:30,search:true,searchoptions:{sopt:["eq","gt","lt","ge","le"]}},{name:"University",
index:"University",width:50,search:true,searchoptions:{sopt:["eq"],dataUrl:"calls/getschool.php"}}],rowNum:20,rowList:[20,30,50],sortname:"Firstname",pager:"#navpager",viewrecords:true,rownumbers:true,sortorder:"desc",caption:"User scores...",loadComplete:function(a){parseInt(a)==100&&info_dialog("error","No records found!","OK","../../../Assets/js/jquery-ui/css/south-street/images/")}}).jqGrid("navGrid","#navpager",{edit:false,add:false,del:false},{},{},{},{multipleSearch:true,odata:["=",
"&ne;","&lt;","&le;","&gt;","&ge;"]},{}).jqGrid("navButtonAdd","#navpager",{caption:"",position:"last",buttonicon:"ui-icon-info",position:"last",title:"View record information",onClickButton:function(){CurrentRowId=$("#userscoretable").getGridParam("selrow");CurrentRowObj=$("#userscoretable").getRowData(CurrentRowId);undefined!=CurrentRowId?loadrecord(CurrentRowId,CurrentRowObj.Firstname+" "+CurrentRowObj.Lastname):info_dialog("Error!","Please select a record","OK","../../../Assets/js/jquery.ui/css/south-street/images/")}});
$(".navbuttonwrapper").find("a").each(function(){$(this).hover(function(){$(this).removeClass("ui-state-default").addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover").addClass("ui-state-default")})});$("#btnpre").click(function(){CurrentRowId=$("#userscoretable").getGridParam("selrow");var a=getCurrPos("#userscoretable",CurrentRowId);a[0]=parseInt(a[0],10);if(a[0]!=-1&&undefined!=a[1][a[0]-1]){CurrentRowId=a[1][a[0]-1];CurrentRowObj=$("#userscoretable").getRowData(CurrentRowId);
loadrecord(CurrentRowId,CurrentRowObj.Firstname+" "+CurrentRowObj.Lastname);$("#userscoretable").setSelection(CurrentRowId);updateNav(a[0]-1,a[1].length-1)}});$("#btnnext").click(function(){CurrentRowId=$("#userscoretable").getGridParam("selrow");var a=getCurrPos("#userscoretable",CurrentRowId);a[0]=parseInt(a[0],10);if(a[0]!=-1&&undefined!=a[1][a[0]+1]){CurrentRowId=a[1][a[0]+1];CurrentRowObj=$("#userscoretable").getRowData(CurrentRowId);loadrecord(CurrentRowId,CurrentRowObj.Firstname+" "+CurrentRowObj.Lastname);
$("#userscoretable").setSelection(CurrentRowId);updateNav(a[0]+1,a[1].length-1)}})});
function loadrecord(a,e){var b="";$("#bodywrapper").empty().block(blockoption);$.getJSON("calls/getsinglerecord.php",{id:a},function(d){if("undefined"==typeof d.msg){b+="<h2>"+d.t+" ( "+d.m+" questions missed )</h2>";if(parseInt(d.m)>0){b+="<h2>List of questions student did wrong</h2>";b+='<table class="ui-widget" cellpadding="0" cellspacing="0">';b+='<thead class="ui-widget-header">';b+='<tr><th>Question</th><th>Correct Answer</th><th>Vocabulary Selected</th><th>Selected Answer</th></tr></thead><tbody class="ui-widget-content">';$.each(d.wrong,
function(f,c){b+="<tr><td>"+c.q+"</td><td>"+c.a+"</td><td>"+c.u+"</td><td>"+c.d+"</td></tr>"});b+="</tbody></table>"}if(parseInt(d.c)>0){b+='<h2>List of questions student did correct</h2><table class="ui-widget" cellpadding="0" cellspacing="0"><thead class="ui-widget-header"><tr><th>Question</th><th>Correct Answer</th></tr></thead><tbody class="ui-widget-content">';$.each(d.right,function(f,c){b+="<tr><td>"+c.q+"</td><td>"+c.a+"</td></tr>"});b+="</tbody></table>"}}else $.each(d.msg,function(f,c){b+=
c.note+"<br />"});$("#bodywrapper").append(b).unblock()});loaddialog("#singlerecordinfo","Detailed test information for record #"+a+" ("+e+")")}function getCurrPos(a,e){var b=$(a).getDataIDs();return[$.inArray(e,b),b]}function updateNav(a,e){a==0?$("a#pre").addClass("ui-state-disabled"):$("a#pre").removeClass("ui-state-disabled");a==e?$("a#next").addClass("ui-state-disabled"):$("a#next").removeClass("ui-state-disabled")}
function loaddialog(a,e){$(a).dialog({bgiframe:true,resizable:true,width:750,height:700,title:"Status",modal:true});$(a).dialog("option","title",e).dialog("open")};