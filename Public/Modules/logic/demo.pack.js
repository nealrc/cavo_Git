var InsertSmallLoadingOptions={width:"15px",height:"15px"},RemoveSmallLoadingOptions={width:"auto",height:"auto"},testing=0;
$(document).ready(function(){var a,b,c;$(".tag").click(function(){testing=1;switch($(this).attr("id")){case "py":a="py";b=1;c="Demo | PinYin Test";break;case "en":a="en";b=2;c="Demo | Chinese-English Test";break;case "cn":a="cn";b=3;c="Demo | Chinese-Chinese Test"}$("body").append($("#diabox"));$("div.jqmdTC").empty().append(c);$("div.jqmdMSG").append($("#testing").show());$("#choices").empty().addClass("loading");$("#testsubject").empty().css(InsertSmallLoadingOptions).addClass("smallloading");$("#questioncount").empty().css(InsertSmallLoadingOptions).addClass("smallloading");
$("#testerror").empty();$.getScript("clearsession.php");$.getJSON("demogenerator.php",{mytestid:b,mytestname:a},function(d){ParseTestData(d)});$("#diabox").jqm({trigger:false,target:false,modal:true,closeClass:false,overlay:95}).jqmShow();$("input.jqmdX").hover(function(){$(this).addClass("jqmdXFocus")},function(){$(this).removeClass("jqmdXFocus")}).focus(function(){this.hideFocus=true;$(this).addClass("jqmdXFocus")}).blur(function(){$(this).removeClass("jqmdXFocus")});$.browser.msie&&$("input").focus(function(){$(this).addClass("iefocus")}).blur(function(){$(this).removeClass("iefocus")})});
$("#testform").submit(function(){$(this).ajaxSubmit({dataType:"json",beforeSubmit:TestLoading,success:function(d){ParseTestData(d);$("#testsubmit").show()}});return false});$(".jqmClose",$("#diabox")).click(function(){ConfirmExit(testing)})});function CleanTestMessage(){$("#choices").empty();$("#testsubject").empty();$("#questioncount").empty();$("#testerror").empty()}function CleanTmpTestMessage(){$("#tmptestsubject").empty();$("#tmpquestioncount").empty();$("#tmptestdisplay").empty()}
function TestLoading(){$("#choices").empty().addClass("loading");$("#testsubject").empty().css(InsertSmallLoadingOptions).addClass("smallloading");$("#questioncount").empty().css(InsertSmallLoadingOptions).addClass("smallloading");$("#testerror").empty();$("#testsubmit").hide()}
function ParseTestData(a){CleanTestMessage();if(parseInt(a.status)==1){$("#testerror").append("error => You must make a selection").slideDown("888");$("#questioncount").removeClass("smallloading").css(RemoveSmallLoadingOptions).append($("#tmpquestioncount").contents().clone());$("#testsubject").removeClass("smallloading").css(RemoveSmallLoadingOptions).append($("#tmptestsubject").contents().clone());var b="<ul>",c=e="",d=0;$("#tmptestdisplay").find("li").each(function(){c=$(this).attr("tid");e=$(this).attr("tname");
b+='<li><input id="t_'+d+'" name="studentanswer" type="radio" value="'+c+'" /><label for="t_'+d+'">'+e+"</label></li>";d++});b+="</ul>";$("#choices").removeClass("loading").append(b)}else if(parseInt(a.status)==2){testing=0;$("#testing").appendTo("body").hide();$(".score").empty().append(a.accuracy+"%");$("#result_details").empty();undefined!=a.info&&$("#result_details").append("<h3>What you did wrong</h3>"+a.info);$("div.jqmdMSG").append($("#finishtest").show())}else{var h="",g="<ul>";$.each(a.data.choice,
function(i,f){g+='<li><input id="t_'+i+'" name="studentanswer" type="radio" value="'+f.id+'" /><label for="t_'+i+'">'+f.testtype+"</label></li>";h+='<li tid="'+f.id+'" tname="'+f.testtype+'"></li>'});g+="</ul>";$("#tmptestsubject").empty().append(a.data.question);$("#tmpquestioncount").empty().append(a.data.num);$("#tmptestdisplay").empty().append(h);$("#questioncount").removeClass("smallloading").css(RemoveSmallLoadingOptions).append(a.data.num);$("#testsubject").removeClass("smallloading").css(RemoveSmallLoadingOptions).append(a.data.question);
$("#choices").removeClass("loading").append(g)}}
function ConfirmExit(a){if(a==1){$("body").append($("#exit"));$("#exit").jqm({overlay:80,modal:true,trigger:false}).jqmShow();$("#exit_yes").click(function(){testing=0;$("body").append($("#testing").hide());$("body").append($("#finishtest").hide());$("#exit").jqmHide();$("#diabox").jqmHide();$("#choices").empty();$("#testsubject").empty();$("#questioncount").empty();$("#testerror").empty();$("#tmptestsubject").empty();$("#tmpquestioncount").empty();$("#tmptestdisplay").empty()});$("#exit_no").click(function(){$("#exit").jqmHide();
$("body").append($("#exit").hide())})}else{$("#r").empty();$("#diabox").jqmHide();$("body").append($("#finishtest").hide());$("body").append($("#exit").hide());$("body").append($("#testing").hide())}};